(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9620],{4654:function(){},3333:function(t,e,s){"use strict";var r=s(8071),n=s.n(r),i=s(1470),a=s.n(i),o=s(6686),c=s.n(o),d=s(7095),l=s.n(d);n().extend(a()),n().extend(c()),n().extend(l()),e.Z=n()},3648:function(t,e,s){"use strict";s.d(e,{k:function(){return a}});var r=s(8227),n=s.n(r),i=s(5566);let a=n()({nestedKey:"payload",level:i.env.NEXT_LOGGER_LEVEL||"info",browser:{asObject:!0}});a.info("[Pino] Logger version is ".concat(a.version)),a.info("[Pino] Logger level is ".concat(a.level))},6943:function(t,e,s){"use strict";s.d(e,{u:function(){return S},k:function(){return P}});var r=s(5355),n=s(4833),i=s(5334),a=s.n(i),o=s(3333),c=s(9463),d=s(3648);class l{static create(t){return new l(t)}async loadCategories(){try{(await this.wp.categories().perPage(c.x.ITEMS_PER_PAGE)).forEach(t=>{this.categoryIdMap.set(t.slug,t)}),this.categoriesLoaded=!0}catch(t){throw d.k.error(t,"Error loading categories"),t}}async loadTags(){try{(await this.wp.tags().perPage(c.x.ITEMS_PER_PAGE)).forEach(t=>{this.tagIdMap.set(t.slug,t)}),this.tagsLoaded=!0}catch(t){throw d.k.error(t,"Error loading tags"),t}}async getCategoryId(t){this.categoriesLoaded||await this.loadCategories();let e=this.categoryIdMap.get(t);if(!e)try{let e=(await this.wp.categories().slug(t))[0];this.categoryIdMap.set(e.slug,e)}catch(s){let e="Error fetching category: ".concat(t);throw d.k.error(e),Error(e)}if(e=this.categoryIdMap.get(t))return e.id}async getTagId(t){this.tagsLoaded||await this.loadTags();let e=this.tagIdMap.get(t);if(!e)try{let e=(await this.wp.tags().slug(t))[0];this.tagIdMap.set(e.slug,e)}catch(s){let e="Error fetching tag: ".concat(t);throw d.k.error(e),Error(e)}if(e=this.tagIdMap.get(t))return e.id}async getTaxonomyIds(t,e){let[s,r]=await Promise.all([this.getCategoryId(t),this.getTagId(e)]);if(void 0===s||void 0===r)throw d.k.error({categorySlug:t,catId:s,tagSlug:e,tagId:r},"undefined category or tag"),Error("undefined category or tag");return[s,r]}async fetchStickyPosts(t){let{categorySlug:e,tagSlug:s}=t,[r,n]=await this.getTaxonomyIds(e,s),i=c.x.ITEMS_PER_PAGE,a=0,o=t=>this.wp.posts().perPage(i).offset(t).orderby("date").order("desc").categories(r).tags(n).after(c.x.djsAnniversarySince.toISOString()).status("publish").sticky(!0).get(),d=await o(a),l=this.mapWpPosts(d),h=[...l];for(;l.length>=i;)a+=i,d=await o(a),h=[...h,...l=this.mapWpPosts(d)];return h}async fetchNonStickyPosts(t){let{categorySlug:e,tagSlug:s,maxPosts:r=c.x.ITEMS_PER_PAGE}=t,[n,i]=await this.getTaxonomyIds(e,s),a=c.x.ITEMS_PER_PAGE,o=0,d=t=>this.wp.posts().perPage(a).offset(t).orderby("date").order("desc").categories(n).tags(i).after(c.x.djsAnniversarySince.toISOString()).status("publish").sticky(!1).get(),l=await d(o),h=this.mapWpPosts(l),g=[...h];for(;r>g.length&&h.length>=a;)o+=a,l=await d(o),g=[...g,...h=this.mapWpPosts(l)];return g}async fetchPosts(t){let{categorySlug:e,tagSlug:s,maxPosts:r=c.x.ITEMS_PER_PAGE}=t,[n,i]=await this.getTaxonomyIds(e,s),a=c.x.ITEMS_PER_PAGE,o=0,d=t=>this.wp.posts().perPage(a).offset(t).orderby("date").order("desc").categories(n).tags(i).after(c.x.djsAnniversarySince.toISOString()).status("publish").get(),l=await d(o),h=this.mapWpPosts(l),g=[...h];for(;r>g.length&&h.length>=a;)o+=a,l=await d(o),g=[...g,...h=this.mapWpPosts(l)];return g}async fetchPost(t){let{postId:e}=t,s=await this.wp.posts().id(e).status("publish").get();return d.k.info(s,"postJson"),g(s)}mapWpPosts(t){return t.map(t=>g(t))}constructor(t){this.categoryIdMap=new Map,this.tagIdMap=new Map,this.categoriesLoaded=!1,this.tagsLoaded=!1,this.wp=t}}let h=l.create(new(a())({endpoint:"https://pta.ycps.edu.hk/wp-json"})),g=t=>({postId:t.id,date:(0,o.Z)(t.date),guid:t.guid.rendered,title:t.title.rendered,content:t.content.rendered,excerpt:t.excerpt.rendered,sticky:t.sticky});async function u(t){return await h.fetchPost(t)}async function p(t){return t.filterSticky?{stickyPosts:await h.fetchStickyPosts(t),posts:await h.fetchNonStickyPosts(t)}:{stickyPosts:[],posts:await h.fetchPosts(t)}}let f=(0,n.no)("categories",{all:null}),x=(0,n.no)("tags",{all:null}),E=(0,n.no)("posts",{single:t=>({queryKey:[t.postId,t],queryFn:e=>u(t)}),categorized:t=>({queryKey:[t.categorySlug,t.tagSlug,t.filterSticky,t],queryFn:e=>p(t)})}),y=(0,n.kR)(f,x,E);function P(t){return(0,r.a)(y.posts.categorized(t))}function S(t){return(0,r.a)(y.posts.single(t))}},9463:function(t,e,s){"use strict";s.d(e,{x:function(){return a}});var r,n,i,a,o=s(3333);(r=a||(a={})).ITEMS_PER_PAGE=100,r.djsAnniversarySince=(0,o.Z)("2022-09-01"),(n=r.TAG_SLUGS||(r.TAG_SLUGS={})).PTA_ALL_TIME="pta-all-time",n.PTA_2022_TO_2024="pta-2022-2024",(i=r.CATEGORY_SLUGS||(r.CATEGORY_SLUGS={})).MEMBERS_NEWS="members-news",i.MEMBERS_NOTICES="members-notices",i.MEMBERS_NEWSLETTERS="members-newsletters",i.MEMBERS_WELFARE="members-welfare",i.PTA_WORDS="pta-words",i.PTA_EXCO="pta-exco",i.PTA_DOCS="pta-docs",i.PTA_CONTACT="pta-contact",i.HELPERS_RECRUIT="helpers-recruit",i.HELPERS_HANDBOOK="helpers-handbook",i.HELPERS_CODE="helpers-code",i.EVENTS_CALENDAR="events-calendar",i.EVENTS_ALBUMS="events-albums"},3412:function(t,e,s){"use strict";s.d(e,{CenteredBox:function(){return n}});var r=s(7999);let n=(0,s(8024).ZP)(r.Z)({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",maxHeight:"400px"})},7502:function(t,e,s){"use strict";s.d(e,{Header:function(){return a}});var r=s(7437),n=s(7999),i=s(3719);function a(){return(0,r.jsx)(n.Z,{sx:{display:"flex",justifyContent:"center"},children:(0,r.jsx)(i.Z,{align:"center",variant:"h4",children:"油蔴地天主教小學(海泓道)家長教師會"})})}},8601:function(t,e,s){"use strict";s.d(e,{Post:function(){return x}});var r=s(7437),n=s(2265),i=s(3684),a=s(7684),o=s(3719),c=s(335),d=s(1222),l=s(7968),h=s(4809),g=s(4216),u=s(811),p=s(9057),f=s(7138);function x(t){let{post:e,collapsible:s=!0,defaultCollapsed:x=!1,showDate:E=!1,showPermaLink:y=!1,showStickiness:P=!1}=t,[S,w]=(0,n.useState)(!!x),j=(0,n.useCallback)(()=>{s&&w(t=>!t)},[s]);return(0,r.jsxs)(i.Z,{component:"article",sx:{padding:1},elevation:4,children:[(0,r.jsxs)(a.Z,{onClick:j,children:[(0,r.jsxs)(a.Z,{direction:"row",bgcolor:"lightgrey",paddingLeft:s?0:1,children:[!!s&&(S?(0,r.jsx)(d.Z,{}):(0,r.jsx)(l.Z,{})),(0,r.jsx)(o.Z,{variant:"h6",children:e.title}),P&&e.sticky&&(0,r.jsx)(h.Z,{fontSize:"small"}),y&&(0,r.jsx)(f.default,{href:{pathname:"/post/",query:{postId:e.postId}},onClick:t=>{t.stopPropagation()},children:(0,r.jsx)(c.Z,{"aria-label":"open post",children:(0,r.jsx)(g.Z,{fontSize:"small"})})})]}),E&&(0,r.jsxs)(o.Z,{variant:"caption",children:[(0,r.jsx)(u.Z,{fontSize:"inherit"})," ",e.date.fromNow()]})]}),!S&&(0,r.jsx)(p.UG,{children:e.content})]})}},6430:function(t,e,s){"use strict";s.d(e,{Posts:function(){return p}});var r=s(7437);s(8160);var n=s(3648),i=s(3719),a=s(6548),o=s(1287),c=s(7684),d=s(2030),l=s(9463),h=s(3412),g=s(6943),u=s(8601);function p(t){let{categorySlug:e,tagSlug:s,showDate:p=!1,maxPosts:f=l.x.ITEMS_PER_PAGE,collapseAfter:x=5,stickyFirst:E,showPermaLink:y=!1,showStickiness:P=!1}=t,{isPending:S,isError:w,data:j,error:_,refetch:m}=(0,g.k)({categorySlug:e,tagSlug:s,filterSticky:!!E,maxPosts:f}),k=async()=>{m()};if(w)return n.k.error(_,"error fetching posts"),(0,r.jsx)("section",{children:(0,r.jsxs)(h.CenteredBox,{children:[(0,r.jsx)(i.Z,{variant:"h5",gutterBottom:!0,color:"error",children:"Error loading data"}),(0,r.jsx)(a.Z,{variant:"contained",onClick:k,children:"Reload"})]})});if(S)return(0,r.jsx)("section",{children:(0,r.jsx)(h.CenteredBox,{children:(0,r.jsx)(o.Z,{})})});let{stickyPosts:I,posts:T}=j;return 0===I.length&&0===T.length?(0,r.jsx)("section",{children:(0,r.jsx)(h.CenteredBox,{children:(0,r.jsx)(i.Z,{children:"Coming soon. Stay tuned."})})}):(0,r.jsxs)("section",{children:[(0,r.jsx)(c.Z,{divider:(0,r.jsx)(d.Z,{flexItem:!0}),children:I.map((t,e)=>(0,r.jsx)(u.Post,{showDate:p,post:t,defaultCollapsed:!1,showPermaLink:y,showStickiness:P},t.guid))}),(0,r.jsx)(c.Z,{divider:(0,r.jsx)(d.Z,{flexItem:!0}),children:T.map((t,e)=>(0,r.jsx)(u.Post,{showDate:p,post:t,defaultCollapsed:void 0!==x&&!(x<0)&&e>=x,showPermaLink:y,showStickiness:P},t.guid))})]})}},9057:function(t,e,s){"use strict";s.d(e,{UG:function(){return o},m$:function(){return l}}),s(3412);var r=s(7437);s(7502);var n=s(8095),i=s(9997),a=s(1531);let o=t=>{let{children:e}=t;return(0,r.jsx)(n.U,{remarkPlugins:[i.Z],rehypePlugins:[a.Z],children:e})};s(8601),s(6430);var c=s(7999),d=s(3719);let l=t=>e=>{let{children:s}=e;return(0,r.jsxs)(c.Z,{children:[(0,r.jsx)("header",{children:(0,r.jsx)(d.Z,{variant:"h5",color:"secondary.contrastText",bgcolor:"secondary.main",paddingX:1,align:"center",children:t.title})}),(0,r.jsx)("section",{children:(0,r.jsx)(c.Z,{sx:{paddingX:0},children:s})})]})}},8160:function(){}}]);