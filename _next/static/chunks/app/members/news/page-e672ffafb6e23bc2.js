(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[447],{24654:function(){},58979:function(t,e,r){Promise.resolve().then(r.bind(r,58380))},96774:function(t,e,r){"use strict";r.d(e,{k:function(){return n}});var a=r(90440),s=r.n(a),i=r(25566);let n=s()({nestedKey:"payload",level:i.env.NEXT_LOGGER_LEVEL||"info",browser:{asObject:!0}});n.info("[Pino] Logger version is ".concat(n.version)),n.info("[Pino] Logger level is ".concat(n.level))},58380:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return C}});var a,s,i=r(57437),n=r(96774),o=r(82498),d=r.n(o),c=r(74548),g=r.n(c),l=r(6537),h=r.n(l),u=r(82399),p=r.n(u),f=r(35140),w=r.n(f);g().extend(h()),g().extend(p()),g().extend(w());var y=g();(a=s||(s={})).djsAnniversarySince=y("2022-09-01"),(a.wpTagSlugs||(a.wpTagSlugs={})).tag2224="22-24",(a.wpCategorySlugs||(a.wpCategorySlugs={})).categoryMembersNews="members-news";class v{static create(t){return new v(t)}async loadCategories(){try{let t=await this.wp.categories();t.forEach(t=>{this.categoryIdMap.set(t.slug,t)}),this.categoriesLoaded=!0}catch(t){throw n.k.error(t,"Error loading categories"),t}}async loadTags(){try{let t=await this.wp.tags();t.forEach(t=>{this.tagIdMap.set(t.slug,t)}),this.tagsLoaded=!0}catch(t){throw n.k.error(t,"Error loading tags"),t}}async getCategoryId(t){this.categoriesLoaded||await this.loadCategories();let e=this.categoryIdMap.get(t);if(!e)try{let e=await this.wp.categories().slug(t),r=e[0];this.categoryIdMap.set(r.slug,r)}catch(r){let e="Error fetching category: ".concat(t);throw n.k.error(e),Error(e)}if(e=this.categoryIdMap.get(t))return e.id}async getTagId(t){this.tagsLoaded||await this.loadTags();let e=this.tagIdMap.get(t);if(!e)try{let e=await this.wp.tags().slug(t),r=e[0];this.tagIdMap.set(r.slug,r)}catch(r){let e="Error fetching tag: ".concat(t);throw n.k.error(e),Error(e)}if(e=this.tagIdMap.get(t))return e.id}async loadPublishedPosts(t){let{categorySlug:e,tagSlug:r}=t,[a,i]=await Promise.all([this.getCategoryId(e),this.getTagId(r)]);if(void 0===a||void 0===i)throw n.k.error({categorySlug:e,catId:a,tagSlug:r,tagId:i},"undefined category or tag"),Error("undefined category or tag");let o=await this.wp.posts().status("publish").categories(a).tags(i).after(s.djsAnniversarySince.toISOString()).orderby("date").order("desc").get();n.k.info(o,"posts fetched");let d=this.mapWpPosts(o);return d}mapWpPosts(t){return t.map(t=>E(t))}constructor(t){this.categoryIdMap=new Map,this.tagIdMap=new Map,this.categoriesLoaded=!1,this.tagsLoaded=!1,this.wp=t}}let x=v.create(new(d())({endpoint:"https://pta.ycps.edu.hk/wp-json"})),E=t=>({postId:t.id,date:y(t.date),guid:t.guid.rendered,title:t.title.rendered,content:t.content.rendered,excerpt:t.excerpt.rendered});var I=r(2265),j=r(6882),k=r(98075),m=r(74404),M=r(29872),P=r(43226),b=r(28179),L=r(81130),S=r(91331),Z=t=>{let{children:e}=t;return(0,i.jsx)(b.D,{remarkPlugins:[L.Z],rehypePlugins:[S.Z],children:e})};function C(t){let{categorySlug:e,tagSlug:r}=t,[a,s]=(0,I.useState)(null),[o,d]=(0,I.useState)(!0),[c,g]=(0,I.useState)([]);return(0,I.useEffect)(()=>{let t=async()=>{try{let t=await x.loadPublishedPosts({categorySlug:e,tagSlug:r});g(t)}catch(t){n.k.error(t,"error fetching posts"),s(t)}finally{d(!1)}};t()},[e,r]),(0,i.jsxs)("section",{children:[o&&(0,i.jsx)(j.Z,{}),(0,i.jsx)(k.Z,{divider:(0,i.jsx)(m.Z,{flexItem:!0}),children:c.map(t=>(0,i.jsxs)(M.Z,{component:"article",sx:{padding:1},elevation:4,children:[(0,i.jsxs)(k.Z,{children:[(0,i.jsx)(P.Z,{variant:"h6",children:t.title}),(0,i.jsx)(P.Z,{variant:"caption",children:t.date.fromNow()})]}),(0,i.jsx)(Z,{children:t.content})]},t.guid))})]})}}},function(t){t.O(0,[625,151,1,249,971,596,744],function(){return t(t.s=58979)}),_N_E=t.O()}]);