(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6626],{24654:function(){},32506:function(t,e,s){"use strict";var r=s(74548),n=s.n(r),i=s(6537),a=s.n(i),o=s(82399),c=s.n(o),d=s(35140),l=s.n(d);n().extend(a()),n().extend(c()),n().extend(l()),e.Z=n()},80510:function(t,e,s){"use strict";s.d(e,{k:function(){return a}});var r=s(90440),n=s.n(r),i=s(25566);let a=n()({nestedKey:"payload",level:i.env.NEXT_LOGGER_LEVEL||"info",browser:{asObject:!0}});a.info("[Pino] Logger version is ".concat(a.version)),a.info("[Pino] Logger level is ".concat(a.level))},99276:function(t,e,s){"use strict";s.d(e,{u:function(){return usePost},k:function(){return usePosts}});var r=s(45771),n=s(12608),i=s(82498),a=s.n(i),o=s(32506),c=s(34683),d=s(80510);let WpClient=class WpClient{static create(t){return new WpClient(t)}async loadCategories(){try{let t=await this.wp.categories().perPage(c.x.ITEMS_PER_PAGE);t.forEach(t=>{this.categoryIdMap.set(t.slug,t)}),this.categoriesLoaded=!0}catch(t){throw d.k.error(t,"Error loading categories"),t}}async loadTags(){try{let t=await this.wp.tags().perPage(c.x.ITEMS_PER_PAGE);t.forEach(t=>{this.tagIdMap.set(t.slug,t)}),this.tagsLoaded=!0}catch(t){throw d.k.error(t,"Error loading tags"),t}}async getCategoryId(t){this.categoriesLoaded||await this.loadCategories();let e=this.categoryIdMap.get(t);if(!e)try{let e=await this.wp.categories().slug(t),s=e[0];this.categoryIdMap.set(s.slug,s)}catch(s){let e="Error fetching category: ".concat(t);throw d.k.error(e),Error(e)}if(e=this.categoryIdMap.get(t))return e.id}async getTagId(t){this.tagsLoaded||await this.loadTags();let e=this.tagIdMap.get(t);if(!e)try{let e=await this.wp.tags().slug(t),s=e[0];this.tagIdMap.set(s.slug,s)}catch(s){let e="Error fetching tag: ".concat(t);throw d.k.error(e),Error(e)}if(e=this.tagIdMap.get(t))return e.id}async getTaxonomyIds(t,e){let[s,r]=await Promise.all([this.getCategoryId(t),this.getTagId(e)]);if(void 0===s||void 0===r)throw d.k.error({categorySlug:t,catId:s,tagSlug:e,tagId:r},"undefined category or tag"),Error("undefined category or tag");return[s,r]}async fetchStickyPosts(t){let{categorySlug:e,tagSlug:s}=t,[r,n]=await this.getTaxonomyIds(e,s),i=c.x.ITEMS_PER_PAGE,a=0,fetchFn=t=>this.wp.posts().perPage(i).offset(t).orderby("date").order("desc").categories(r).tags(n).after(c.x.djsAnniversarySince.toISOString()).status("publish").sticky(!0).get(),o=await fetchFn(a),d=this.mapWpPosts(o),l=[...d];for(;d.length>=i;)a+=i,o=await fetchFn(a),l=[...l,...d=this.mapWpPosts(o)];return l}async fetchNonStickyPosts(t){let{categorySlug:e,tagSlug:s,maxPosts:r=c.x.ITEMS_PER_PAGE}=t,[n,i]=await this.getTaxonomyIds(e,s),a=c.x.ITEMS_PER_PAGE,o=0,fetchFn=t=>this.wp.posts().perPage(a).offset(t).orderby("date").order("desc").categories(n).tags(i).after(c.x.djsAnniversarySince.toISOString()).status("publish").sticky(!1).get(),d=await fetchFn(o),l=this.mapWpPosts(d),h=[...l];for(;r>h.length&&l.length>=a;)o+=a,d=await fetchFn(o),h=[...h,...l=this.mapWpPosts(d)];return h}async fetchPosts(t){let{categorySlug:e,tagSlug:s,maxPosts:r=c.x.ITEMS_PER_PAGE}=t,[n,i]=await this.getTaxonomyIds(e,s),a=c.x.ITEMS_PER_PAGE,o=0,fetchFn=t=>this.wp.posts().perPage(a).offset(t).orderby("date").order("desc").categories(n).tags(i).after(c.x.djsAnniversarySince.toISOString()).status("publish").get(),d=await fetchFn(o),l=this.mapWpPosts(d),h=[...l];for(;r>h.length&&l.length>=a;)o+=a,d=await fetchFn(o),h=[...h,...l=this.mapWpPosts(d)];return h}async fetchPost(t){let{postId:e}=t,s=await this.wp.posts().id(e).status("publish").get();return d.k.info(s,"postJson"),wpPostFromJson(s)}mapWpPosts(t){return t.map(t=>wpPostFromJson(t))}constructor(t){this.categoryIdMap=new Map,this.tagIdMap=new Map,this.categoriesLoaded=!1,this.tagsLoaded=!1,this.wp=t}};let l=WpClient.create(new(a())({endpoint:"https://pta.ycps.edu.hk/wp-json"})),wpPostFromJson=t=>({postId:t.id,date:(0,o.Z)(t.date),guid:t.guid.rendered,title:t.title.rendered,content:t.content.rendered,excerpt:t.excerpt.rendered,sticky:t.sticky});async function fetchPost(t){return await l.fetchPost(t)}async function fetchPosts(t){if(t.filterSticky){let e=await l.fetchStickyPosts(t),s=await l.fetchNonStickyPosts(t);return{stickyPosts:e,posts:s}}let e=await l.fetchPosts(t);return{stickyPosts:[],posts:e}}let h=(0,n.no)("categories",{all:null}),u=(0,n.no)("tags",{all:null}),g=(0,n.no)("posts",{single:t=>({queryKey:[t.postId,t],queryFn:e=>fetchPost(t)}),categorized:t=>({queryKey:[t.categorySlug,t.tagSlug,t.filterSticky,t],queryFn:e=>fetchPosts(t)})}),p=(0,n.kR)(h,u,g);function usePosts(t){return(0,r.a)(p.posts.categorized(t))}function usePost(t){return(0,r.a)(p.posts.single(t))}},90979:function(t,e,s){"use strict";s.r(e),s.d(e,{CenteredBox:function(){return i}});var r=s(96507),n=s(35843);let i=(0,n.ZP)(r.Z)({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",maxHeight:"400px"})},21337:function(t,e,s){"use strict";s.r(e),s.d(e,{Header:function(){return Header}});var r=s(57437),n=s(96507),i=s(85269);function Header(){return(0,r.jsx)(n.Z,{sx:{display:"flex",justifyContent:"center"},children:(0,r.jsx)(i.Z,{align:"center",variant:"h4",children:"油蔴地天主教小學(海泓道)家長教師會"})})}},81686:function(t,e,s){"use strict";s.d(e,{S:function(){return Post}});var r=s(57437),n=s(2265),i=s(18687),a=s(13457),o=s(85269),c=s(46776),d=s(70001),l=s(95780),h=s(95211),u=s(7910),g=s(89457),p=s(33502),f=s(61396),x=s.n(f);function Post(t){let{post:e,collapsible:s=!0,defaultCollapsed:f=!1,showDate:E=!1,showPermaLink:P=!1,showStickiness:y=!1}=t,[S,w]=(0,n.useState)(!!f),j=(0,n.useCallback)(()=>{s&&w(t=>!t)},[s]);return(0,r.jsxs)(i.Z,{component:"article",sx:{padding:1},elevation:4,children:[(0,r.jsxs)(a.Z,{onClick:j,children:[(0,r.jsxs)(a.Z,{direction:"row",bgcolor:"lightgrey",paddingLeft:s?0:1,children:[!!s&&(S?(0,r.jsx)(d.Z,{}):(0,r.jsx)(l.Z,{})),(0,r.jsx)(o.Z,{variant:"h6",children:e.title}),y&&e.sticky&&(0,r.jsx)(h.Z,{fontSize:"small"}),P&&(0,r.jsx)(x(),{href:{pathname:"/post/",query:{postId:e.postId}},onClick:t=>{t.stopPropagation()},children:(0,r.jsx)(c.Z,{"aria-label":"open post",children:(0,r.jsx)(u.Z,{fontSize:"small"})})})]}),E&&(0,r.jsxs)(o.Z,{variant:"caption",children:[(0,r.jsx)(g.Z,{fontSize:"inherit"})," ",e.date.fromNow()]})]}),!S&&(0,r.jsx)(p.UG,{children:e.content})]})}},11548:function(t,e,s){"use strict";s.r(e),s.d(e,{Posts:function(){return Posts}});var r=s(57437);s(6205);var n=s(80510),i=s(85269),a=s(49600),o=s(47042),c=s(13457),d=s(54986),l=s(34683),h=s(90979),u=s(99276),g=s(81686);function Posts(t){let{categorySlug:e,tagSlug:s,showDate:p=!1,maxPosts:f=l.x.ITEMS_PER_PAGE,collapseAfter:x=5,stickyFirst:E,showPermaLink:P=!1,showStickiness:y=!1}=t,{isPending:S,isError:w,data:j,error:_,refetch:m}=(0,u.k)({categorySlug:e,tagSlug:s,filterSticky:!!E,maxPosts:f}),handleReload=async()=>{m()};if(w)return n.k.error(_,"error fetching posts"),(0,r.jsx)("section",{children:(0,r.jsxs)(h.CenteredBox,{children:[(0,r.jsx)(i.Z,{variant:"h5",gutterBottom:!0,color:"error",children:"Error loading data"}),(0,r.jsx)(a.Z,{variant:"contained",onClick:handleReload,children:"Reload"})]})});if(S)return(0,r.jsx)("section",{children:(0,r.jsx)(h.CenteredBox,{children:(0,r.jsx)(o.Z,{})})});let{stickyPosts:k,posts:T}=j;return 0===k.length&&0===T.length?(0,r.jsx)("section",{children:(0,r.jsx)(h.CenteredBox,{children:(0,r.jsx)(i.Z,{children:"Coming soon. Stay tuned."})})}):(0,r.jsxs)("section",{children:[(0,r.jsx)(c.Z,{divider:(0,r.jsx)(d.Z,{flexItem:!0}),children:k.map((t,e)=>(0,r.jsx)(g.S,{showDate:p,post:t,defaultCollapsed:!1,showPermaLink:P,showStickiness:y},t.guid))}),(0,r.jsx)(c.Z,{divider:(0,r.jsx)(d.Z,{flexItem:!0}),children:T.map((t,e)=>(0,r.jsx)(g.S,{showDate:p,post:t,defaultCollapsed:void 0!==x&&!(x<0)&&e>=x,showPermaLink:P,showStickiness:y},t.guid))})]})}},33502:function(t,e,s){"use strict";s.d(e,{UG:function(){return Markdown},m$:function(){return TitledLayout}});var r=s(57437),n=s(96507),i=s(85269);let TitledLayout=t=>e=>{let{children:s}=e;return(0,r.jsxs)(n.Z,{children:[(0,r.jsx)("header",{children:(0,r.jsx)(i.Z,{variant:"h5",color:"secondary.contrastText",bgcolor:"secondary.main",paddingX:1,align:"center",children:t.title})}),(0,r.jsx)("section",{children:(0,r.jsx)(n.Z,{sx:{paddingX:0},children:s})})]})};s(21337);var a=s(13581),o=s(98809),c=s(65082);let Markdown=t=>{let{children:e}=t;return(0,r.jsx)(a.U,{remarkPlugins:[o.Z],rehypePlugins:[c.Z],children:e})};s(11548)},34683:function(t,e,s){"use strict";s.d(e,{x:function(){return a}});var r,n,i,a,o=s(32506);(r=a||(a={})).ITEMS_PER_PAGE=100,r.djsAnniversarySince=(0,o.Z)("2022-09-01"),(n=r.TAG_SLUGS||(r.TAG_SLUGS={})).PTA_ALL_TIME="pta-all-time",n.PTA_2022_TO_2024="pta-2022-2024",(i=r.CATEGORY_SLUGS||(r.CATEGORY_SLUGS={})).MEMBERS_NEWS="members-news",i.MEMBERS_NOTICES="members-notices",i.MEMBERS_NEWSLETTERS="members-newsletters",i.MEMBERS_WELFARE="members-welfare",i.PTA_WORDS="pta-words",i.PTA_EXCO="pta-exco",i.PTA_DOCS="pta-docs",i.PTA_CONTACT="pta-contact",i.HELPERS_RECRUIT="helpers-recruit",i.HELPERS_HANDBOOK="helpers-handbook",i.HELPERS_CODE="helpers-code",i.EVENTS_CALENDAR="events-calendar",i.EVENTS_ALBUMS="events-albums"},6205:function(){}}]);